---
cip: 0019
title: JWT signer for DID-JWT
author: @daoauth
discussions-to: <URL>
status: Draft
type: 
category: 
created: 2020-09-09
license: Apache 2.0
---

## Simple Summary
JWT encryption is required for web and did support.

## Abstract
- Now signer interface has 4 methods (signTransaction, signPersonalMessage, getNativeKey, decrypt).
- And add a one more signer for did-jwt.
- Because of security, jwt signer and tx signer are using same pk. so it need store in same wallet.
- And it's not possible with ledger-wallet
- It's maybe very useful and strong interface for DIDs. VCs, and more. (eg. HTTP Authentication header type)
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIXVCJ9TJV...r7E20RMHrHDcEfxjoYZgeFONFh7HgQ
```

## Motivation
Addition of signer class function is required for web environment and extensibility of did. When JWT encryption is supported, a system that can be used in traditional web login and DIDs and VCs are completed.

## Specification
- did-jwt has a own [simple signer](https://github.com/decentralized-identity/did-jwt/blob/master/src/SimpleSigner.ts).
- Make a new interface & method with this source.

```javascript
const { sha256, setLength } = require('ethereumjs-util')
const { ec } = require('elliptic')
const secp256k1 = new ec('secp256k1')

function getJwtSigner(hexPrivateKey) {
  if (hexPrivateKey.startsWith('0x')) {
    hexPrivateKey = hexPrivateKey.substring(2)
  }
  const privateKey = secp256k1.keyFromPrivate(hexPrivateKey)
  return async data => {
    const { r, s, recoveryParam } = privateKey.sign(sha256(data))
    return {
      r: setLength(Buffer.from(r.toString('hex'), 'hex'), 32, false).toString('hex'),
      s: setLength(Buffer.from(s.toString('hex'), 'hex'), 32, false).toString('hex'),
      recoveryParam
    }
  }
}

```

## Backwards Compatibility
Add only jwt signer to the signer interface([wallet](https://github.com/celo-org/celo-monorepo/blob/master/packages/contractkit/src/wallets/wallet.ts)).

## Implementation
- [did-jwt](https://github.com/decentralized-identity/did-jwt)
- [did-jwt-vc](https://github.com/decentralized-identity/did-jwt-vc)
```jwt
const didJWT = require('did-jwt')
// const signer = didJWT.SimpleSigner('278a5de700e29faae8e40e366ec5012b5ec63d36ec77e8a2417154cc1d25383f');
const signer = celoJWT.SimpleSigner(); // Set to use the cello's JWT signer.

let jwt = await didJWT.createJWT({aud: 'did:ethr:0xf3beac30c498d9e26865f34fcaa57dbb935b0d74', exp: 1957463421, name: 'uPort Developer'},
                 {alg: 'ES256K', issuer: 'did:ethr:0xf3beac30c498d9e26865f34fcaa57dbb935b0d74', signer})
console.log(jwt);
```

## License
This work is licensed under the Apache License, Version 2.0.
